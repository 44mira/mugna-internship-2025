#+TITLE:     Django notes
#+AUTHOR:    Author
#+DATE:      2025-06-02

* First Django Project
  - ~python manage.py~
    - ~runserver~
      - Possible to pass a ~PORT~
      - or a ~IP:PORT~

  - Django determines the /root/ URLconf by looking at the ~ROOT_URLCONF~
    setting.

** ~views.py~
   - Write handlers
** ~urls.py~
   - Write routers

* Templates
  - Express presentation, not program logic
  - Separate the presentation of a document from its data
  - Double braces for value injection from context ~{{ <variable> }}~
    - Surrounded with percent signs and single brace for code injection ~{% <code> %}~
  - You can set the templates directory in the ~TEMPLATE~ variable in ~settings.py~.
  - Loaded with ~django.template.loader import get_template~
    - or ~django.shortcuts import render~
      - takes in a ~request~, ~template~, and ~context~
    - ~TemplateDoesNotExist~ exception

  1. Create a ~Template~ object
  2. Call ~<template>.render(<context>)~
     - Returns the template as a string

** Syntax
   #+BEGIN_SRC py
   t = Template("Hello {{ name }}") # create wrapped template string
   c = Context({"name": "world"})   # define context/environment

   print(t.render(c))
   #+END_SRC

** Injection
   #+BEGIN_SRC html
   {% if %} {% elif %} {% else %} {% endif %}
   {% for <x> in <xs> %} {% empty %} {% endfor %}
   {% comment <note> %}
   {% cycle <a> <b> <c> %}
   {% include <name> %}
   #+END_SRC

** Filters
   - Transformations applied using pipe ~|~.
     - ~title~
       - Titlecase
     - ~first~
     - ~upper~
     - ~truncatewords:"30"~
     - ~date:"<format>"~

** Custom tags and filters
   - Using the ~{% load filters tags %}~ tag.
   - It needs to be in a Django application.
     - ~templatetags/~ directory
   - Pipes are forwarded as the first argument of a function
     - The filter argument will be the rest

   - Define custom tags with decorator
     ~@register.simple_tag(takes_context=True)~
   - Define custom tags with filter
     ~@register.filter(name="filter_name")~

** Template Inheritance
   - Layouts
   - ~{% extends %}~ must be the first tag in the template

*** Syntax
    #+BEGIN_SRC html
    {% extends <name> %}
    {% block <name> %} {% endblock %}
    {% block.super %}
    #+END_SRC

* CSRF Token
  - Cross site request forgery

* Project vs App
** Project
   - Instance of a certain set of Django apps, plus configuration for those apps
   - Contains settings file
** App
   - Portable set of django functionality
   - For modularization

* Models and Django ORM
  - SQLite
  - /Dumb/ queries are done usually for performance
  - Import a model and then access the ~QuerySet~ containing all using
    ~.objects~ method.

  - Models should be named in singular form

** Fields
   - ~models.CharField~
   - ~models.TextField~
   - ~models.IntegerField~
   - ~models.DecimalField~
   - ~models.FileField~
   - ~models.DateTimeField~
   - ~models.EmailField~
   - ~models.OneToOneField~
   - ~models.ForeignKey~
     - ~related_name~ kwarg is used for accessing
     - One-to-many
   - ~models.ManyToManyField~
     - ~related_name~ kwarg is used for accessing

** Kwargs
   - ~verbose_name~
     - For admin label
   - ~help_text~
     - For admin help text
   - ~max_length~

** Migrations
   - Schema /evolution/ or /mutation/
   - Changing your database version from one version into another
   - We can rollback migrations by using ~python manage.py migrate <app> <id>~
